{"version":3,"sources":["../../../../src/app/admin/users/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\n\ninterface User {\n  id: number;\n  email: string;\n  username: string;\n  display_name: string;\n  role: string;\n  created_at: string;\n}\n\nexport default function AdminUsersPage() {\n  const router = useRouter();\n  const [users, setUsers] = useState<User[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n\n  async function loadUsers() {\n    const res = await fetch(\"/api/admin/users\");\n    if (res.status === 403) {\n      router.push(\"/login\");\n      return;\n    }\n    const data = await res.json();\n    setUsers(data.users || []);\n    setLoading(false);\n  }\n\n  useEffect(() => {\n    loadUsers();\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  async function changeRole(userId: number, role: string) {\n    setError(\"\");\n    const res = await fetch(\"/api/admin/users\", {\n      method: \"PATCH\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ userId, role }),\n    });\n    const data = await res.json();\n    if (!res.ok) {\n      setError(data.error);\n      return;\n    }\n    loadUsers();\n  }\n\n  const roleColors: Record<string, string> = {\n    admin: \"bg-red-100 text-red-700\",\n    moderator: \"bg-amber-100 text-amber-700\",\n    user: \"bg-gray-100 text-gray-600\",\n  };\n\n  if (loading) {\n    return (\n      <div className=\"max-w-6xl mx-auto px-4 py-8\">\n        <p className=\"text-gray-400\">Loading users...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"max-w-6xl mx-auto px-4 py-8\">\n      <h1 className=\"text-3xl font-bold text-brg mb-6\">User Management</h1>\n\n      {error && (\n        <div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6 text-sm\">{error}</div>\n      )}\n\n      <div className=\"bg-white rounded-xl shadow overflow-hidden\">\n        <table className=\"w-full text-left\">\n          <thead className=\"bg-brg text-cream\">\n            <tr>\n              <th className=\"px-6 py-3 text-sm font-semibold\">User</th>\n              <th className=\"px-6 py-3 text-sm font-semibold\">Email</th>\n              <th className=\"px-6 py-3 text-sm font-semibold\">Role</th>\n              <th className=\"px-6 py-3 text-sm font-semibold\">Joined</th>\n              <th className=\"px-6 py-3 text-sm font-semibold\">Actions</th>\n            </tr>\n          </thead>\n          <tbody className=\"divide-y divide-gray-100\">\n            {users.map((u) => (\n              <tr key={u.id} className=\"hover:bg-cream/30\">\n                <td className=\"px-6 py-4\">\n                  <div className=\"font-medium text-gray-800\">{u.display_name}</div>\n                  <div className=\"text-gray-400 text-sm\">@{u.username}</div>\n                </td>\n                <td className=\"px-6 py-4 text-gray-600 text-sm\">{u.email}</td>\n                <td className=\"px-6 py-4\">\n                  <span className={`text-xs font-medium px-2 py-0.5 rounded-full ${roleColors[u.role] || roleColors.user}`}>\n                    {u.role}\n                  </span>\n                </td>\n                <td className=\"px-6 py-4 text-gray-400 text-sm\">{new Date(u.created_at).toLocaleDateString()}</td>\n                <td className=\"px-6 py-4\">\n                  <select\n                    value={u.role}\n                    onChange={(e) => changeRole(u.id, e.target.value)}\n                    className=\"text-sm border border-gray-300 rounded-lg px-2 py-1 outline-none focus:ring-2 focus:ring-brg text-gray-700\"\n                  >\n                    <option value=\"user\">User</option>\n                    <option value=\"moderator\">Moderator</option>\n                    <option value=\"admin\">Admin</option>\n                  </select>\n                </td>\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}